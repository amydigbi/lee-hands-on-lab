steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: a4dfd50e-bc99-43e8-bbe1-8ea6ced23e3f
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 31a2ec03-a3b3-460f-9e34-90e36c4ba01e
                    stepCounter: 198e9bca-b9dd-4edd-bff3-2ba2e1f74dbc
                transform: ""
          - columnReference:
              columnCounter: da4715ad-5d36-46f5-85a9-99a61aee672d
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fd69eeb9-d32b-4535-8b4b-12aba33c4321
                    stepCounter: 2888fae4-92b1-405d-9afe-dab944e6c878
                transform: ""
          - columnReference:
              columnCounter: a4708cab-1f19-4ec3-83f9-c559e161d6df
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: eb245310-e93c-4b84-9a60-d73e73cbb925
                    stepCounter: cddb2e54-d0a8-4aa3-8fce-7670e08552db
                transform: ""
          - columnReference:
              columnCounter: 00fdf5ae-7587-4086-9510-727d2dbc51dc
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1ddaa0f0-8582-45f2-a699-78c5292e6c06
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 9dee6e2c-0080-4ea9-8654-8ad1d6d7f025
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 016dca70-696b-4e7b-a5a0-9e36cb0502f9
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: fadd58d2-335e-4813-b879-6efde8f2cc27
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b997df8d-edfc-42a9-8d70-7f0d2ab332cf
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 3644e3da-661b-43be-a6f3-1069723f9b60
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 59ba38c3-221c-4fe6-a97f-9fe81c47d79e
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 7c9f50fc-4550-4f10-9018-0183e36a76ef
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7d4652f7-a27f-4e20-b205-4a48fca78dbd
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 708ac35d-957d-440d-b5ef-7245969c669e
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5d188552-87c7-4c4a-9d5b-58ee8fc6a800
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 0a2191e5-ef24-4e5d-b176-e254d78535f9
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 60a40661-ffda-4dd5-8d80-2a81f56839ef
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 44f666c8-ba96-432b-935c-87b5d006cce8
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 36fda99b-3b06-438e-9dbb-f226a226a035
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: c056a8e3-7b18-4f67-ab04-58a61ea54ea6
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f3706856-345a-41bf-b255-450dc4dc8de6
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 6df638c2-d2ab-4ca7-81ee-f72db5141538
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 33ea5f4d-8790-4613-8a82-571efe033d4e
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: dbd9499b-ef85-4a1c-8b2e-c6d2b9a8783e
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c6bdf69f-4a36-49d6-ab86-4104c1e6405f
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 76b752ff-1d49-44a3-8931-27563431d1e8
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3cf42b4b-4cad-451a-8505-f95988401786
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 0afb4f3f-5e71-4436-bbf9-d6b2f33a3650
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9673a6ad-6fe4-4a59-b0bd-f848c26b5ae8
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 569b2d34-c291-45d1-9e3a-eb6751337d01
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8122295b-1370-4495-92c5-ab91546e4d1d
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 06f897eb-83fa-47ef-82a7-0300a0cd898e
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ebf4ec53-a46e-402c-b772-269316dd8cb6
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: d6b43f83-e3fa-49e8-b8c1-597b39dfc0dd
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fbe0d04d-d5ad-4379-9b05-ff65ff94c14a
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 0b614c86-3051-4e66-a037-27395705077f
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINEITEM_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bd5a5617-4a86-46ec-813a-d7c1f97f0be2
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 26f43315-3f02-43ce-ac2a-22f99177edf0
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 792e6be8-93b0-4593-95c9-7e86c829aaec
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: ae4a7da6-e334-45fa-a2cc-cfd73e5bab35
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9914cd09-5b46-46a2-8d4c-b0bb8506a7a0
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: f97caa4d-ca6e-4913-84d5-0d5a3667c493
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c9eab16d-08cc-4aa2-9119-6e9f5a62a279
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 2bc420ef-4f38-460d-850b-e5e7d98e9679
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 026af417-bfb8-4986-ab25-ffd1554e4d56
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: a09a2de8-d137-4c3f-b852-6ce8877e3d10
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: acf89e4d-26fa-4ef5-a36f-753d1e611b2a
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: a5bb4d91-5674-4c1a-ba40-a57a991afbf3
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bb5a04d0-17b8-4da9-9c27-05249898446a
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 6aa306bb-cda5-4498-b639-10bf897dc2d4
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 891dae2e-e64f-440d-a856-782fe5317ad5
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: f393defe-8834-4f3a-b541-decf0eb1c3f3
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 625ff37b-d0a6-49ed-ae9f-34a0274b2638
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 6221e0ad-512e-4a77-b1f3-c05c503c3cc5
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ORDER_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: eddd7c75-7e22-4ebd-8b25-c0e488eb89a4
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - columnReference:
              columnCounter: 45b91956-ce47-449e-bd91-4f6dc162b45d
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b7e500d5-8c8d-4d70-a994-15eda0373d96
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 7818a7b0-7523-4f5f-bc71-4dad584178ed
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7c2a7a80-9d86-4f79-934d-0ae978642a9e
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: cd04a027-3b27-47ae-b9a3-08960de843fb
              stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b0780b4f-6626-497c-86d6-126ffb1f2989
                    stepCounter: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 198e9bca-b9dd-4edd-bff3-2ba2e1f74dbc
              DIM_PART: 2888fae4-92b1-405d-9afe-dab944e6c878
              DIM_SUPPLIER: cddb2e54-d0a8-4aa3-8fce-7670e08552db
              STG_LINEITEM_ORDERS: fbf511f9-d6cf-4ee2-997e-7d1e3eec34b6
              STG_PARTSUPP: 78de5279-8c04-4217-aa99-022a16836531
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: fc2deed8-dec2-46bd-9bf9-2f4f8fd866d0
